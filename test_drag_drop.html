<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Drag & Drop</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vuedraggable/4.1.0/vuedraggable.umd.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .kanban-board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 20px;
        }
        
        .kanban-column {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 16px;
            min-height: 400px;
        }
        
        .column-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 2px solid #e9ecef;
        }
        
        .column-title {
            font-size: 18px;
            font-weight: bold;
            color: #495057;
        }
        
        .task-count {
            background: #007bff;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .task-card {
            background: white;
            border-radius: 6px;
            padding: 12px;
            margin-bottom: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: move;
            transition: all 0.2s ease;
            border-left: 4px solid #007bff;
        }
        
        .task-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        
        .task-title {
            font-weight: bold;
            margin-bottom: 4px;
            color: #212529;
        }
        
        .task-description {
            font-size: 14px;
            color: #6c757d;
            margin-bottom: 8px;
        }
        
        .task-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 12px;
            color: #6c757d;
        }
        
        .priority-badge {
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: bold;
        }
        
        .priority-high { background: #dc3545; color: white; }
        .priority-medium { background: #ffc107; color: #212529; }
        .priority-low { background: #28a745; color: white; }
        
        .sortable-ghost {
            opacity: 0.5;
            background: #c8ebfb;
            border: 2px dashed #007bff;
        }
        
        .sortable-drag {
            opacity: 0.8;
            transform: rotate(5deg);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
        
        .debug-info {
            background: #e9ecef;
            padding: 16px;
            border-radius: 6px;
            margin-bottom: 20px;
            font-family: monospace;
            font-size: 14px;
        }
        
        .debug-title {
            font-weight: bold;
            margin-bottom: 8px;
            color: #495057;
        }
        
        .status-pending { border-left-color: #ffc107; }
        .status-in-progress { border-left-color: #fd7e14; }
        .status-completed { border-left-color: #28a745; }
    </style>
</head>
<body>
    <div id="app">
        <div class="container">
            <h1>ðŸ§ª Teste de Drag & Drop - Sistema Kanban</h1>
            
            <div class="debug-info">
                <div class="debug-title">ðŸ“Š InformaÃ§Ãµes de Debug:</div>
                <div>Total de tarefas: {{ totalTasks }}</div>
                <div>Pendentes: {{ pendingTasks.length }}</div>
                <div>Em Progresso: {{ inProgressTasks.length }}</div>
                <div>ConcluÃ­das: {{ completedTasks.length }}</div>
                <div>Ãšltima aÃ§Ã£o: {{ lastAction }}</div>
            </div>
            
            <div class="kanban-board">
                <!-- Coluna: Pendentes -->
                <div class="kanban-column">
                    <div class="column-header">
                        <div class="column-title">ðŸ“‹ Pendentes</div>
                        <div class="task-count">{{ pendingTasks.length }}</div>
                    </div>
                    
                    <draggable 
                        v-model="pendingTasks" 
                        group="tasks"
                        class="space-y-2"
                        item-key="id"
                        :animation="300"
                        ghost-class="sortable-ghost"
                        drag-class="sortable-drag"
                        @start="onDragStart"
                        @end="onDragEnd"
                        @change="onDragChange">
                        
                        <template #item="{ element: task }">
                            <div class="task-card status-pending">
                                <div class="task-title">{{ task.title }}</div>
                                <div class="task-description">{{ task.description }}</div>
                                <div class="task-meta">
                                    <span class="priority-badge" :class="'priority-' + task.priority">
                                        {{ getPriorityLabel(task.priority) }}
                                    </span>
                                    <span>ID: {{ task.id }}</span>
                                </div>
                            </div>
                        </template>
                    </draggable>
                </div>
                
                <!-- Coluna: Em Progresso -->
                <div class="kanban-column">
                    <div class="column-header">
                        <div class="column-title">âš¡ Em Progresso</div>
                        <div class="task-count">{{ inProgressTasks.length }}</div>
                    </div>
                    
                    <draggable 
                        v-model="inProgressTasks" 
                        group="tasks"
                        class="space-y-2"
                        item-key="id"
                        :animation="300"
                        ghost-class="sortable-ghost"
                        drag-class="sortable-drag"
                        @start="onDragStart"
                        @end="onDragEnd"
                        @change="onDragChange">
                        
                        <template #item="{ element: task }">
                            <div class="task-card status-in-progress">
                                <div class="task-title">{{ task.title }}</div>
                                <div class="task-description">{{ task.description }}</div>
                                <div class="task-meta">
                                    <span class="priority-badge" :class="'priority-' + task.priority">
                                        {{ getPriorityLabel(task.priority) }}
                                    </span>
                                    <span>ID: {{ task.id }}</span>
                                </div>
                            </div>
                        </template>
                    </draggable>
                </div>
                
                <!-- Coluna: ConcluÃ­das -->
                <div class="kanban-column">
                    <div class="column-header">
                        <div class="column-title">âœ… ConcluÃ­das</div>
                        <div class="task-count">{{ completedTasks.length }}</div>
                    </div>
                    
                    <draggable 
                        v-model="completedTasks" 
                        group="tasks"
                        class="space-y-2"
                        item-key="id"
                        :animation="300"
                        ghost-class="sortable-ghost"
                        drag-class="sortable-drag"
                        @start="onDragStart"
                        @end="onDragEnd"
                        @change="onDragChange">
                        
                        <template #item="{ element: task }">
                            <div class="task-card status-completed">
                                <div class="task-title">{{ task.title }}</div>
                                <div class="task-description">{{ task.description }}</div>
                                <div class="task-meta">
                                    <span class="priority-badge" :class="'priority-' + task.priority">
                                        {{ getPriorityLabel(task.priority) }}
                                    </span>
                                    <span>ID: {{ task.id }}</span>
                                </div>
                            </div>
                        </template>
                    </draggable>
                </div>
            </div>
            
            <div style="margin-top: 20px; text-align: center;">
                <button @click="addTestTask" style="background: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 6px; cursor: pointer;">
                    âž• Adicionar Tarefa de Teste
                </button>
                <button @click="resetTasks" style="background: #6c757d; color: white; padding: 10px 20px; border: none; border-radius: 6px; cursor: pointer; margin-left: 10px;">
                    ðŸ”„ Resetar Tarefas
                </button>
            </div>
        </div>
    </div>

    <script>
        const { createApp, ref, computed } = Vue;
        
        createApp({
            setup() {
                // Dados de teste
                const tasks = ref([
                    { id: 1, title: 'Tarefa 1', description: 'DescriÃ§Ã£o da tarefa 1', status: 'pending', priority: 'high' },
                    { id: 2, title: 'Tarefa 2', description: 'DescriÃ§Ã£o da tarefa 2', status: 'pending', priority: 'medium' },
                    { id: 3, title: 'Tarefa 3', description: 'DescriÃ§Ã£o da tarefa 3', status: 'in_progress', priority: 'low' },
                    { id: 4, title: 'Tarefa 4', description: 'DescriÃ§Ã£o da tarefa 4', status: 'completed', priority: 'high' },
                    { id: 5, title: 'Tarefa 5', description: 'DescriÃ§Ã£o da tarefa 5', status: 'completed', priority: 'medium' }
                ]);
                
                const lastAction = ref('Nenhuma aÃ§Ã£o ainda');
                let taskCounter = 5;
                
                // Computed properties para as colunas
                const pendingTasks = computed({
                    get: () => tasks.value.filter(task => task.status === 'pending'),
                    set: (value) => {
                        console.log('ðŸ”„ Computed set - pendingTasks:', value);
                        updateTaskStatuses(value, 'pending');
                    }
                });
                
                const inProgressTasks = computed({
                    get: () => tasks.value.filter(task => task.status === 'in_progress'),
                    set: (value) => {
                        console.log('ðŸ”„ Computed set - inProgressTasks:', value);
                        updateTaskStatuses(value, 'in_progress');
                    }
                });
                
                const completedTasks = computed({
                    get: () => tasks.value.filter(task => task.status === 'completed'),
                    set: (value) => {
                        console.log('ðŸ”„ Computed set - completedTasks:', value);
                        updateTaskStatuses(value, 'completed');
                    }
                });
                
                const totalTasks = computed(() => tasks.value.length);
                
                // FunÃ§Ãµes
                const updateTaskStatuses = (newTasks, newStatus) => {
                    console.log(`ðŸš€ Atualizando tarefas para status: ${newStatus}`, newTasks);
                    
                    newTasks.forEach(task => {
                        if (task.status !== newStatus) {
                            const taskIndex = tasks.value.findIndex(t => t.id === task.id);
                            if (taskIndex !== -1) {
                                tasks.value[taskIndex].status = newStatus;
                                lastAction.value = `Tarefa "${task.title}" movida para ${getStatusLabel(newStatus)}`;
                                console.log(`âœ… Tarefa ${task.id} movida para ${newStatus}`);
                            }
                        }
                    });
                };
                
                const onDragStart = (event) => {
                    console.log('ðŸš€ Drag started:', event.dragged.element.id);
                    lastAction.value = `Iniciando drag da tarefa ${event.dragged.element.id}`;
                };
                
                const onDragEnd = (event) => {
                    console.log('âœ… Drag ended:', event.dragged.element.id);
                    lastAction.value = `Drag finalizado para tarefa ${event.dragged.element.id}`;
                };
                
                const onDragChange = (event) => {
                    console.log('ðŸ”„ Drag change:', event);
                    if (event.added) {
                        lastAction.value = `Tarefa adicionada Ã  coluna`;
                    } else if (event.removed) {
                        lastAction.value = `Tarefa removida da coluna`;
                    }
                };
                
                const getPriorityLabel = (priority) => {
                    const labels = { low: 'Baixa', medium: 'MÃ©dia', high: 'Alta' };
                    return labels[priority] || priority;
                };
                
                const getStatusLabel = (status) => {
                    const labels = { 
                        pending: 'Pendentes', 
                        in_progress: 'Em Progresso', 
                        completed: 'ConcluÃ­das' 
                    };
                    return labels[status] || status;
                };
                
                const addTestTask = () => {
                    taskCounter++;
                    const newTask = {
                        id: taskCounter,
                        title: `Tarefa ${taskCounter}`,
                        description: `DescriÃ§Ã£o da tarefa ${taskCounter}`,
                        status: 'pending',
                        priority: ['low', 'medium', 'high'][Math.floor(Math.random() * 3)]
                    };
                    tasks.value.push(newTask);
                    lastAction.value = `Nova tarefa "${newTask.title}" criada`;
                };
                
                const resetTasks = () => {
                    tasks.value = [
                        { id: 1, title: 'Tarefa 1', description: 'DescriÃ§Ã£o da tarefa 1', status: 'pending', priority: 'high' },
                        { id: 2, title: 'Tarefa 2', description: 'DescriÃ§Ã£o da tarefa 2', status: 'pending', priority: 'medium' },
                        { id: 3, title: 'Tarefa 3', description: 'DescriÃ§Ã£o da tarefa 3', status: 'in_progress', priority: 'low' },
                        { id: 4, title: 'Tarefa 4', description: 'DescriÃ§Ã£o da tarefa 4', status: 'completed', priority: 'high' },
                        { id: 5, title: 'Tarefa 5', description: 'DescriÃ§Ã£o da tarefa 5', status: 'completed', priority: 'medium' }
                    ];
                    taskCounter = 5;
                    lastAction.value = 'Tarefas resetadas para estado inicial';
                };
                
                return {
                    tasks,
                    pendingTasks,
                    inProgressTasks,
                    completedTasks,
                    totalTasks,
                    lastAction,
                    onDragStart,
                    onDragEnd,
                    onDragChange,
                    getPriorityLabel,
                    getStatusLabel,
                    addTestTask,
                    resetTasks
                };
            }
        }).mount('#app');
    </script>
</body>
</html> 