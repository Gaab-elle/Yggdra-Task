<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Drag & Drop Simples</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vuedraggable/4.1.0/vuedraggable.umd.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .kanban-board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 20px;
        }
        .kanban-column {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .column-header {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e5e7eb;
        }
        .task-card {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 10px;
            cursor: move;
            transition: all 0.2s ease;
        }
        .task-card:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }
        .task-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .task-description {
            color: #6b7280;
            font-size: 14px;
        }
        .status {
            margin-top: 20px;
            padding: 10px;
            background: #f3f4f6;
            border-radius: 6px;
            font-family: monospace;
        }
        .ghost {
            opacity: 0.5;
            background: #dbeafe;
        }
        .chosen {
            background: #fef3c7;
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="container">
            <h1>ðŸ§ª Teste Drag & Drop Simples</h1>
            <p>Arraste as tarefas entre as colunas para testar o funcionamento.</p>
            
            <div class="kanban-board">
                <!-- Coluna: Pendentes -->
                <div class="kanban-column">
                    <div class="column-header">ðŸ“‹ Pendentes ({{ pendingTasks.length }})</div>
                    <draggable 
                        v-model="pendingTasks" 
                        group="tasks"
                        class="space-y-3"
                        item-key="id"
                        ghost-class="ghost"
                        chosen-class="chosen">
                        <template #item="{ element: task }">
                            <div class="task-card">
                                <div class="task-title">{{ task.title }}</div>
                                <div class="task-description">{{ task.description }}</div>
                            </div>
                        </template>
                    </draggable>
                </div>

                <!-- Coluna: Em Progresso -->
                <div class="kanban-column">
                    <div class="column-header">ðŸ”„ Em Progresso ({{ inProgressTasks.length }})</div>
                    <draggable 
                        v-model="inProgressTasks" 
                        group="tasks"
                        class="space-y-3"
                        item-key="id"
                        ghost-class="ghost"
                        chosen-class="chosen">
                        <template #item="{ element: task }">
                            <div class="task-card">
                                <div class="task-title">{{ task.title }}</div>
                                <div class="task-description">{{ task.description }}</div>
                            </div>
                        </template>
                    </draggable>
                </div>

                <!-- Coluna: ConcluÃ­das -->
                <div class="kanban-column">
                    <div class="column-header">âœ… ConcluÃ­das ({{ completedTasks.length }})</div>
                    <draggable 
                        v-model="completedTasks" 
                        group="tasks"
                        class="space-y-3"
                        item-key="id"
                        ghost-class="ghost"
                        chosen-class="chosen">
                        <template #item="{ element: task }">
                            <div class="task-card">
                                <div class="task-title">{{ task.title }}</div>
                                <div class="task-description">{{ task.description }}</div>
                            </div>
                        </template>
                    </draggable>
                </div>
            </div>

            <div class="status">
                <strong>Status:</strong> {{ status }}<br>
                <strong>Ãšltima aÃ§Ã£o:</strong> {{ lastAction }}<br>
                <strong>Total de tarefas:</strong> {{ totalTasks }}
            </div>
        </div>
    </div>

    <script>
        const { createApp, ref, computed } = Vue;
        const { draggable } = vuedraggable;

        createApp({
            components: {
                draggable
            },
            setup() {
                const status = ref('âœ… Pronto para testar');
                const lastAction = ref('Nenhuma aÃ§Ã£o ainda');

                // Dados de exemplo
                const tasks = ref([
                    { id: 1, title: 'Tarefa 1', description: 'DescriÃ§Ã£o da tarefa 1', status: 'pending' },
                    { id: 2, title: 'Tarefa 2', description: 'DescriÃ§Ã£o da tarefa 2', status: 'pending' },
                    { id: 3, title: 'Tarefa 3', description: 'DescriÃ§Ã£o da tarefa 3', status: 'in_progress' },
                    { id: 4, title: 'Tarefa 4', description: 'DescriÃ§Ã£o da tarefa 4', status: 'in_progress' },
                    { id: 5, title: 'Tarefa 5', description: 'DescriÃ§Ã£o da tarefa 5', status: 'completed' },
                    { id: 6, title: 'Tarefa 6', description: 'DescriÃ§Ã£o da tarefa 6', status: 'completed' }
                ]);

                // Computed properties
                const pendingTasks = computed({
                    get: () => tasks.value.filter(task => task.status === 'pending'),
                    set: (value) => {
                        console.log('ðŸ”„ Computed set - pendingTasks:', value);
                        updateTaskStatuses(value, 'pending');
                    }
                });

                const inProgressTasks = computed({
                    get: () => tasks.value.filter(task => task.status === 'in_progress'),
                    set: (value) => {
                        console.log('ðŸ”„ Computed set - inProgressTasks:', value);
                        updateTaskStatuses(value, 'in_progress');
                    }
                });

                const completedTasks = computed({
                    get: () => tasks.value.filter(task => task.status === 'completed'),
                    set: (value) => {
                        console.log('ðŸ”„ Computed set - completedTasks:', value);
                        updateTaskStatuses(value, 'completed');
                    }
                });

                const totalTasks = computed(() => tasks.value.length);

                // FunÃ§Ãµes
                const updateTaskStatuses = (newTasks, newStatus) => {
                    console.log(`ðŸš€ Atualizando tarefas para status: ${newStatus}`, newTasks);
                    
                    newTasks.forEach(task => {
                        if (task.status !== newStatus) {
                            const taskIndex = tasks.value.findIndex(t => t.id === task.id);
                            if (taskIndex !== -1) {
                                tasks.value[taskIndex].status = newStatus;
                                lastAction.value = `Tarefa "${task.title}" movida para ${getStatusLabel(newStatus)}`;
                                status.value = 'âœ… Funcionando!';
                                console.log(`âœ… Tarefa ${task.id} movida para ${newStatus}`);
                            }
                        }
                    });
                };

                const getStatusLabel = (status) => {
                    const labels = { 
                        pending: 'Pendentes', 
                        in_progress: 'Em Progresso', 
                        completed: 'ConcluÃ­das' 
                    };
                    return labels[status] || status;
                };

                return {
                    tasks,
                    pendingTasks,
                    inProgressTasks,
                    completedTasks,
                    totalTasks,
                    status,
                    lastAction
                };
            }
        }).mount('#app');
    </script>
</body>
</html> 